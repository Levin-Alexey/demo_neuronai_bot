"""–û–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–Ω–æ–ø–∫–∏ '–ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è HR'"""

import asyncio
from aiogram import types, F, Router
from aiogram.types import ReplyKeyboardMarkup, KeyboardButton

router = Router()


def get_hr_keyboard() -> ReplyKeyboardMarkup:
    """–ë–∞–∑–æ–≤–æ–µ –º–µ–Ω—é HR –æ—Ç–¥–µ–ª–∞."""
    return ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üé≠ –ü—Ä–æ–π—Ç–∏ —Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–µ")],
            [KeyboardButton(text="üìÑ –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—é–º–µ (CV Scan)")],
            [KeyboardButton(text="üî• –ë—ã—Å—Ç—Ä—ã–π –ø–æ–¥–±–æ—Ä")],
            [KeyboardButton(text="‚öôÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è HR")],
            [KeyboardButton(text="üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é")],
        ],
        resize_keyboard=True,
    )


@router.message(F.text == "‚öôÔ∏è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–ª—è HR")
async def hr_section_intro(message: types.Message) -> None:
    """–ü—Ä–µ–∑–µ–Ω—Ç–∞—Ü–∏—è –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π HR-–ø–∞–Ω–µ–ª–∏ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º –¥–µ–º–æ."""

    intro_text = (
        "‚öôÔ∏è <b>–ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è (HR Control Center)</b>\n\n"
        "–≠—Ç–æ ¬´–º–æ–∑–≥–æ–≤–æ–π —Ü–µ–Ω—Ç—Ä¬ª –≤–∞—à–µ–π —Å–∏—Å—Ç–µ–º—ã –Ω–∞–π–º–∞. –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å —Å–≤–æ–¥—è—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –∏–∑ –≤—Å–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ (hh.ru, Telegram, CRM, –ø–æ—á—Ç–∞).\n\n"
        "üöÄ <b>–ß—Ç–æ –∑–¥–µ—Å—å —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –¥–ª—è –±–∏–∑–Ω–µ—Å–∞:</b>\n"
        "üìä <b>–°–∫–≤–æ–∑–Ω–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞:</b> –í–æ—Ä–æ–Ω–∫–∞ –æ—Ç –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–∞–∫–∞–Ω—Å–∏–∏ –¥–æ –æ—Ñ—Ñ–µ—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏.\n"
        "üí∞ <b>ROI & –ë—é–¥–∂–µ—Ç:</b> –†–∞—Å—á–µ—Ç —Å—Ç–æ–∏–º–æ—Å—Ç–∏ –Ω–∞–π–º–∞ (Cost per Hire) –∏ —ç–∫–æ–Ω–æ–º–∏–∏ –¥–µ–Ω–µ–≥ –∑–∞ —Å—á–µ—Ç –ò–ò.\n"
        "üö® <b>–°–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤:</b> –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è, –µ—Å–ª–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç ¬´–∑–∞–≤–∏—Å¬ª –Ω–∞ —ç—Ç–∞–ø–µ –∏–ª–∏ –≤–æ—Ä–æ–Ω–∫–∞ –ø—Ä–æ—Å–µ–ª–∞.\n"
        "üìÇ <b>–≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö:</b> –í—ã–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –¥–∏–∞–ª–æ–≥–æ–≤ –∏ —Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏–π –≤ Excel/1C/Bitrix24.\n\n"
        "üëá <b>–ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å, –∫–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç —Å–≤–æ–¥–Ω—ã–π –æ—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é.</b>"
    )

    # –ö–ª–∞–≤–∏–∞—Ç—É—Ä–∞ —Å –∫–Ω–æ–ø–∫–æ–π –¥–ª—è –ø–æ–∫–∞–∑–∞ –¥–µ–º–æ
    demo_keyboard = ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üìä –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ–º–æ-–æ—Ç—á–µ—Ç")],
            [KeyboardButton(text="üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é")]
        ],
        resize_keyboard=True
    )

    await message.answer(
        intro_text,
        parse_mode="HTML",
        reply_markup=demo_keyboard
    )


@router.message(F.text == "üìä –ü–æ–∫–∞–∑–∞—Ç—å –¥–µ–º–æ-–æ—Ç—á–µ—Ç")
async def show_hr_dashboard(message: types.Message) -> None:
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∞–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–æ–π –ø–∞–Ω–µ–ª–∏ –¥–ª—è HR-–¥–∏—Ä–µ–∫—Ç–æ—Ä–∞."""

    # 1. –≠—Ñ—Ñ–µ–∫—Ç –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö (–ò–º–∏—Ç–∞—Ü–∏—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ CRM)
    loading_msg = await message.answer("üîÑ <i>–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å ATS –∏ CRM-—Å–∏—Å—Ç–µ–º–æ–π...</i>", parse_mode="HTML")
    await asyncio.sleep(1.0)

    await loading_msg.edit_text("üìä <i>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∏ –ø–æ –≤–æ—Ä–æ–Ω–∫–µ –Ω–∞–π–º–∞...</i>", parse_mode="HTML")
    await asyncio.sleep(1.2)

    await loading_msg.delete()

    # 2. –§–æ—Ä–º–∏—Ä—É–µ–º –∫—Ä–∞—Å–∏–≤—ã–π –¥–∞—à–±–æ—Ä–¥
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ (ASCII/Emoji bars) –¥–ª—è –Ω–∞–≥–ª—è–¥–Ω–æ—Å—Ç–∏

    dashboard_text = (
        "üìä <b>HR-COCKPIT: –û—Ç—á–µ—Ç –∑–∞ –Ω–µ–¥–µ–ª—é</b>\n"
        "<i>–ü–µ—Ä–∏–æ–¥: 16.12 ‚Äî 22.12</i>\n\n"
        
        "<b>1Ô∏è‚É£ –≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ò–ò-–∞–≥–µ–Ω—Ç–æ–≤:</b>\n"
        "‚ö° <b>–û–±—Ä–∞–±–æ—Ç–∞–Ω–æ –æ—Ç–∫–ª–∏–∫–æ–≤:</b> 842\n"
        "ü§ñ <b>–ê–≤—Ç–æ-—Å–æ–±–µ—Å–µ–¥–æ–≤–∞–Ω–∏–π:</b> 124\n"
        "üí∞ <b>–°—ç–∫–æ–Ω–æ–º–ª–µ–Ω–æ –≤—Ä–µ–º–µ–Ω–∏:</b> ~54 —á–∞—Å–∞\n"
        "<i>(–≠–∫–≤–∏–≤–∞–ª–µ–Ω—Ç —Ä–∞–±–æ—Ç—ã 1.5 —Ä–µ–∫—Ä—É—Ç–µ—Ä–æ–≤)</i>\n\n"
        
        "<b>2Ô∏è‚É£ –í–æ—Ä–æ–Ω–∫–∞ –Ω–∞–π–º–∞ (Conversion Rate):</b>\n"
        "<code>–û—Ç–∫–ª–∏–∫–∏   : ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà 100% (842)</code>\n"
        "<code>CV –°–∫–∞–Ω   : ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë 65% (547)</code>\n"
        "<code>–ò–ò-–ò–Ω—Ç–µ—Ä–≤.: ‚ñà‚ñà‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 28% (235)</code>\n"
        "<code>–§–∏–Ω–∞–ª–∏—Å—Ç—ã : ‚ñà‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë‚ñë 8% (67)</code>\n\n"
        
        "<b>3Ô∏è‚É£ –õ—É—á—à–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤:</b>\n"
        "ü•á Telegram (42%) ‚Äî <i>—Å–∞–º—ã–µ –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ</i>\n"
        "ü•à HeadHunter (35%)\n"
        "ü•â LinkedIn (23%)\n\n"
        
        "‚ö†Ô∏è <b>–¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:</b>\n"
        "‚Ä¢ –ü–æ–∑–∏—Ü–∏—è <i>Senior Python Dev</i>: –º–∞–ª–æ –æ—Ç–∫–ª–∏–∫–æ–≤ (–Ω—É–∂–µ–Ω –±—É—Å—Ç).\n"
        "‚Ä¢ 3 –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ –æ–∂–∏–¥–∞—é—Ç –æ—Ñ—Ñ–µ—Ä–∞ –±–æ–ª–µ–µ 24 —á–∞—Å–æ–≤.\n\n"
        
        "üëá <b>–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:</b>"
    )

    # 3. –ö–Ω–æ–ø–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–¥ –æ—Ç—á–µ—Ç–æ–º
    inline_kb = ReplyKeyboardMarkup(
        keyboard=[
            [KeyboardButton(text="üì• –°–∫–∞—á–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π PDF (Demo)")],
            [KeyboardButton(text="üîô –ù–∞–∑–∞–¥ –≤ –º–µ–Ω—é")]
        ],
        resize_keyboard=True
    )

    # –ù–∞–¥—ë–∂–Ω—ã–π PNG —Å Wikimedia (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π Content-Type image/png)
    photo_url = (
        "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/"
        "Business_presentation_illustration2.svg/1024px-"
        "Business_presentation_illustration2.svg.png"
    )

    # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –¥–∞—à–±–æ—Ä–¥ —Å –∫–∞—Ä—Ç–∏–Ω–∫–æ–π; –µ—Å–ª–∏ –Ω–µ –ø–æ–ª—É—á–∏—Ç—Å—è, —à–ª—ë–º —Ç–µ–∫—Å—Ç –±–µ–∑ —Ñ–æ—Ç–æ
    try:
        await message.answer_photo(
            photo=photo_url,
            caption=dashboard_text,
            parse_mode="HTML",
            reply_markup=inline_kb
        )
    except Exception:
        # –§–æ–ª–ª–±—ç–∫: —Ç–µ–∫—Å—Ç–æ–º –±–µ–∑ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
        await message.answer(
            dashboard_text,
            parse_mode="HTML",
            reply_markup=inline_kb
        )


@router.message(F.text == "üì• –°–∫–∞—á–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π PDF (Demo)")
async def download_demo_report(message: types.Message) -> None:
    """–û–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è PDF –æ—Ç—á–µ—Ç–∞ (–∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è –¥–µ–º–æ)."""
    await message.answer(
        "üìÇ <b>–ì–µ–Ω–µ—Ä–∞—Ü–∏—è PDF –æ—Ç—á–µ—Ç–∞...</b>\n\n"
        "(–í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–æ–µ–∫—Ç–µ –∑–¥–µ—Å—å –±–æ—Ç –ø—Ä–∏—Å—ã–ª–∞–µ—Ç –¥–æ–∫—É–º–µ–Ω—Ç —Å –ø–æ–ª–Ω–æ–π –∞–Ω–∞–ª–∏—Ç–∏–∫–æ–π, "
        "—Ç—Ä–∞–Ω—Å–∫—Ä–∏–ø—Ü–∏—è–º–∏ –∑–≤–æ–Ω–∫–æ–≤ –∏ —Ä–µ–π—Ç–∏–Ω–≥–æ–º –≤—Å–µ—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤).",
        parse_mode="HTML",
        reply_markup=get_hr_keyboard()
    )


def register_handlers(main_router: Router) -> None:
    """–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–ª—è HR"""
    main_router.include_router(router)

