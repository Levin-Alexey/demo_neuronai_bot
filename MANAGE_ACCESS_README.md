# üõ† –£—Ç–∏–ª–∏—Ç–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –û–ø–∏—Å–∞–Ω–∏–µ

`manage_access.py` - –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è —É—Ç–∏–ª–∏—Ç–∞ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤, –ø–æ–∑–≤–æ–ª—è—é—â–∞—è –ª–µ–≥–∫–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ –±–æ—Ç—É —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å–Ω–æ–µ –º–µ–Ω—é.

## –ó–∞–ø—É—Å–∫

```bash
python manage_access.py
```

## –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

```
============================================================
ü§ñ –£–ü–†–ê–í–õ–ï–ù–ò–ï –î–û–°–¢–£–ü–û–ú –ö –ë–û–¢–£
============================================================
1. üë§ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
2. ‚è∞ –ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
3. üë• –ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
4. ‚úÖ –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
5. ‚ùå –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–µ–∫—à–∏–º –¥–æ—Å—Ç—É–ø–æ–º
6. üö™ –í—ã—Ö–æ–¥
============================================================
```

## –§—É–Ω–∫—Ü–∏–∏

### 1Ô∏è‚É£ –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –¥–æ—Å—Ç—É–ø–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
- Telegram ID
- –î–∞—Ç–∞ –Ω–∞—á–∞–ª–∞ –¥–æ—Å—Ç—É–ø–∞
- –î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞
- –°—Ç–∞—Ç—É—Å (–∞–∫—Ç–∏–≤–µ–Ω/–∏—Å—Ç–µ–∫)
- –û—Å—Ç–∞–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è –∏–ª–∏ –≤—Ä–µ–º—è —Å –∏—Å—Ç–µ—á–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä:**
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ (1-6): 1
–í–≤–µ–¥–∏—Ç–µ Telegram ID: 123456789

üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ 123456789
   –ù–∞—á–∞–ª–æ –¥–æ—Å—Ç—É–ø–∞: 2026-01-13 10:30:00+00:00
   –ö–æ–Ω–µ—Ü –¥–æ—Å—Ç—É–ø–∞:  2026-01-14 10:30:00+00:00
   ‚úÖ –°—Ç–∞—Ç—É—Å: –ê–ö–¢–ò–í–ï–ù
   ‚è∞ –û—Å—Ç–∞–ª–æ—Å—å: 18 —á. 45 –º–∏–Ω.
```

### 2Ô∏è‚É£ –ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
–ü—Ä–æ–¥–ª–µ–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –æ–¥–Ω–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤.

**–ü—Ä–∏–º–µ—Ä:**
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ (1-6): 2
–í–≤–µ–¥–∏—Ç–µ Telegram ID: 123456789
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 24): 48

‚úÖ –î–æ—Å—Ç—É–ø –ø—Ä–æ–¥–ª–µ–Ω –Ω–∞ 48 —á–∞—Å–æ–≤
```

### 3Ô∏è‚É£ –ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
–ú–∞—Å—Å–æ–≤–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ –¥–ª—è —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

**–ü—Ä–∏–º–µ—Ä:**
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ (1-6): 3
–í–≤–µ–¥–∏—Ç–µ Telegram ID —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é: 123456789, 987654321, 555555555
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 24): 24

‚úÖ –£—Å–ø–µ—à–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω–æ: 3 –ø–æ–ª—å–∑.
   ID: [123456789, 987654321, 555555555]
```

### 4Ô∏è‚É£ –°–ø–∏—Å–æ–∫ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω—ã–º –¥–æ—Å—Ç—É–ø–æ–º.

**–ü—Ä–∏–º–µ—Ä:**
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ (1-6): 4

‚úÖ –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: 15
   123456789: –æ—Å—Ç–∞–ª–æ—Å—å 18—á 45–º
   987654321: –æ—Å—Ç–∞–ª–æ—Å—å 5—á 20–º
   555555555: –æ—Å—Ç–∞–ª–æ—Å—å 22—á 10–º
   ...
```

### 5Ô∏è‚É£ –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–µ–∫—à–∏–º –¥–æ—Å—Ç—É–ø–æ–º
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, —É –∫–æ—Ç–æ—Ä—ã—Ö –¥–æ—Å—Ç—É–ø –∏—Å—Ç–µ–∫.

**–ü—Ä–∏–º–µ—Ä:**
```
–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ (1-6): 5

‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–µ–∫—à–∏–º –¥–æ—Å—Ç—É–ø–æ–º: 8
   111111111: –∏—Å—Ç–µ–∫ 5—á –Ω–∞–∑–∞–¥
   222222222: –∏—Å—Ç–µ–∫ 12—á –Ω–∞–∑–∞–¥
   333333333: –∏—Å—Ç–µ–∫ 24—á –Ω–∞–∑–∞–¥
   ...
```

## –ü—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–í—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ —Å–∫—Ä–∏–ø—Ç–∞ –≤ —Å–≤–æ–µ–º –∫–æ–¥–µ:

```python
from manage_access import (
    get_user_info,
    extend_access,
    extend_access_multiple,
    get_active_users,
    get_expired_users
)

# –ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
user_info = get_user_info(123456789)
print(user_info)

# –ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø
success = extend_access(123456789, hours=48)

# –ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
result = extend_access_multiple([123456789, 987654321], hours=24)

# –ü–æ–ª—É—á–∏—Ç—å –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
active = get_active_users()

# –ü–æ–ª—É—á–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–µ–∫—à–∏–º –¥–æ—Å—Ç—É–ø–æ–º
expired = get_expired_users()
```

## API —Ñ—É–Ω–∫—Ü–∏–π

### `get_user_info(telegram_id: int) -> dict | None`
–ü–æ–ª—É—á–∏—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    "telegram_id": 123456789,
    "started_at": datetime(...),
    "access_until": datetime(...),
    "has_access": True,
    "time_left": timedelta(...),  # –µ—Å–ª–∏ –∞–∫—Ç–∏–≤–µ–Ω
    "expired_ago": timedelta(...)  # –µ—Å–ª–∏ –∏—Å—Ç–µ–∫
}
```

### `extend_access(telegram_id: int, hours: int = 24) -> bool`
–ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `telegram_id` - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `hours` - –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —á–∞—Å–æ–≤ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 24)

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:** `True` –µ—Å–ª–∏ —É—Å–ø–µ—à–Ω–æ, `False` –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω

### `extend_access_multiple(telegram_ids: list[int], hours: int = 24) -> dict`
–ü—Ä–æ–¥–ª–∏—Ç—å –¥–æ—Å—Ç—É–ø –Ω–µ—Å–∫–æ–ª—å–∫–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**
```python
{
    "success": [123456789, 987654321],  # —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ–¥–ª–µ–Ω—ã
    "failed": [111111111]                # –Ω–µ –Ω–∞–π–¥–µ–Ω—ã
}
```

### `get_active_users() -> list[dict]`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.

### `get_expired_users() -> list[dict]`
–ü–æ–ª—É—á–∏—Ç—å —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏—Å—Ç–µ–∫—à–∏–º –¥–æ—Å—Ç—É–ø–æ–º.

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
```bash
python -c "from manage_access import extend_access; extend_access(123456789, 48)"
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
```python
from manage_access import get_active_users, get_expired_users

active = get_active_users()
expired = get_expired_users()

print(f"–ê–∫—Ç–∏–≤–Ω—ã—Ö: {len(active)}")
print(f"–ò—Å—Ç–µ–∫—à–∏—Ö: {len(expired)}")
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–æ–¥–ª–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –∏—Å—Ç–µ–∫—à–∏—Ö
```python
from manage_access import get_expired_users, extend_access

expired = get_expired_users()
for user in expired:
    extend_access(user['telegram_id'], hours=24)
    print(f"‚úÖ –ü—Ä–æ–¥–ª–µ–Ω –¥–æ—Å—Ç—É–ø –¥–ª—è {user['telegram_id']}")
```

## –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è

### –°–æ–∑–¥–∞—Ç—å –∑–∞–¥–∞—á—É –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–¥–ª–µ–Ω–∏—è (Windows Task Scheduler)
```bash
# –°–æ–∑–¥–∞–π—Ç–µ .bat —Ñ–∞–π–ª:
@echo off
cd /d "E:\dev\python\demo_neuronai_bot"
python manage_access_auto.py
```

### Cron –∑–∞–¥–∞—á–∞ (Linux)
```bash
# –î–æ–±–∞–≤—å—Ç–µ –≤ crontab:
0 */6 * * * cd /path/to/bot && python manage_access_auto.py
```

### –ü—Ä–∏–º–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞ (manage_access_auto.py)
```python
from manage_access import get_expired_users, extend_access
from datetime import datetime

# –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–¥–ª–µ–≤–∞—Ç—å –¥–æ—Å—Ç—É–ø –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º,
# —É –∫–æ—Ç–æ—Ä—ã—Ö –æ–Ω –∏—Å—Ç–µ–∫ –º–µ–Ω–µ–µ 3 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
expired = get_expired_users()
extended_count = 0

for user in expired:
    hours_expired = user['expired_ago'].total_seconds() / 3600
    
    if hours_expired < 3:  # –ò—Å—Ç–µ–∫ –º–µ–Ω–µ–µ 3 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥
        if extend_access(user['telegram_id'], hours=24):
            extended_count += 1
            print(f"‚úÖ –ê–≤—Ç–æ–ø—Ä–æ–¥–ª–µ–Ω–∏–µ: {user['telegram_id']}")

print(f"\nüìä –ü—Ä–æ–¥–ª–µ–Ω–æ: {extended_count} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π")
print(f"‚è∞ –í—Ä–µ–º—è: {datetime.now()}")
```

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

- Python 3.11+
- SQLAlchemy
- python-dotenv
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL –ë–î

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

‚ö†Ô∏è **–í–∞–∂–Ω–æ:**
- –£—Ç–∏–ª–∏—Ç–∞ –∏–º–µ–µ—Ç –ø—Ä—è–º–æ–π –¥–æ—Å—Ç—É–ø –∫ –ë–î
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–æ–ª—å–∫–æ –¥–æ–≤–µ—Ä–µ–Ω–Ω—ã–º–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞–º–∏
- –ù–µ –¥–∞–≤–∞–π—Ç–µ –¥–æ—Å—Ç—É–ø –∫ `.env` —Ñ–∞–π–ª—É —Å `DATABASE_URL`

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–î–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –¥–æ–±–∞–≤—å—Ç–µ:

```python
import logging

logging.basicConfig(
    filename='access_management.log',
    level=logging.INFO,
    format='%(asctime)s - %(message)s'
)

# –í —Ñ—É–Ω–∫—Ü–∏–∏ extend_access:
logging.info(f"Access extended for user {telegram_id} for {hours} hours")
```

## –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º

### "DATABASE_URL –Ω–µ –Ω–∞–π–¥–µ–Ω"
–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ñ–∞–π–ª `.env` —Å–æ–¥–µ—Ä–∂–∏—Ç:
```
DATABASE_URL=postgresql://user:password@host:port/database
```

### "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –Ω–∞–π–¥–µ–Ω"
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ø—É—Å–∫–∞–ª `/start` –≤ –±–æ—Ç–µ.

### –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î
–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
1. –ë–î –∑–∞–ø—É—â–µ–Ω–∞
2. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ credentials –≤ `.env`
3. –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —Ö–æ—Å—Ç–∞ –∏ –ø–æ—Ä—Ç–∞

---

**–ê–≤—Ç–æ—Ä:** –í–∞—à–∞ –∫–æ–º–∞–Ω–¥–∞  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 13 —è–Ω–≤–∞—Ä—è 2026  
**–í–µ—Ä—Å–∏—è:** 1.0
